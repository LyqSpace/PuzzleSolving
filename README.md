# PuzzleSolving-tool

This is a package contains three tools for puzzle solving:

1. Generator in Python.
2. Generator in Javascript (deprecated). [link](https://lyqspace.github.io/PuzzleSolving-tool/generator.html)
3. Debugger in Javascript. [link](https://lyqspace.github.io/PuzzleSolving-tool/debugger.html)

## Usages

### Generator in Python

A tool for generating puzzles. 

Run `python3 generate_puzzle.py -i data/sample.png`.

Requirement: OpenCV in Python.

Optional arguments:

| option | value | description |
| ---- | ---- | ---- |
| -h --help | | show this help message and exit |
| -i | IMG_PATH | Path to the input image. |
| -n | PIECE_N | Number of puzzle pieces. Default is 10. The actual number of puzzle pieces may be different. |
| -t | SAMPLE_N | Number of puzzle you want to generate from the input image. Default is 1. |
| --offset-h | OFFSET_H | Provide the horizontal offset rate when chopping the image. Default is 1. The offset is the rate of the initial rigid piece height. If the value is less than 0.5, no interaction will happen. |
| --offset-w | OFFSET_W | Provide the vertical offset rate when chopping the image. Default is 1. The offset is the rate of the initial piece width. If the value is less than 0.5, no interaction will happen. |
| -s | SMALL_REGION | A threshold controls the minimum area of a region with respect to initial rigid piece area. Default is 0.25. |
| -r | ROTATE | A range of random rotation (in degree) applied on puzzle pieces. Default is 180. The value should be in \[0, 180\]. Each piece randomly select a rotation degree in \[-r, r\] |
| --bg_color | BG_COLOR | Background color to fill the empty area. Default is \[0, 0, 0\]. The type is three uint8 numbers in BGR OpenCV format. |

The output file tree is:

```bash
.
├── data
│   ├── puzzles
│   │   ├── 0
│   │   │   ├── config.txt
│   │   │   ├── groundtruth.json
│   │   │   ├── groundtruth.txt
│   │   │   ├── puzzle-0.zip
│   │   │   ├── piece-0.png
│   │   │   ├── piece-1.png
│   │   │   ├── piece-2.png
│   │   │   ├── piece-3.png
│   │   │   └── ....
│   │   ├── 1
│   │   │   ├── config.txt
│   │   │   ├── groundtruth.json
│   │   │   ├── groundtruth.txt
│   │   │   ├── puzzle-1.zip
│   │   │   ├── piece-0.png
│   │   │   ├── piece-1.png
│   │   │   ├── piece-2.png
│   │   │   ├── piece-3.png
│   │   │   └── ....
│   │   └── ....
```

File formats:
1. config.txt:
    1. First line: prefix of piece images, is always "piece-".
    2. Second line: number of piece images, one integer.
    3. Third line: bg color for empty areas in BGR OpenCV format.
2. groundtruth.json (used for Debugger in Javascript):
    1. id: piece id.
    2. dx: horizontal translation of the piece.
    3. dy: vertical translation of the piece.
    4. rotation: clockwise rotation of the piece with respect to the center (radius).
3. groundtruth.txt (used for other programs):
  It is the same as the groundtruth.json, the three values per line are: dx, dy, and rotation.
4. puzzle-X.zip (used for Debugger in Javascript):
  A package contains all piece images and the config file. 

### Debugger in Javascript

1. Upload a package of pieces, which must contains all piece images and the config file. The puzzle can be generated by Debugger in Python or Debugger in Javascript.
2. Upload a groundtruth file in json format to see the groundtruth composition.
3. You can interactively maniplute any two pieces.
